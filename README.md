# 今日餐點抽卡系統（Restaurant Gacha）

## 1. 專案定位

本專案是一個結合「餐廳推薦」與「抽卡機制」的趣味 Web
應用。使用者可於不同群組（如學校附近、家裡附近）中進行抽卡，系統依稀有度機率抽出一間推薦餐廳，並提供收藏、歷史紀錄等功能。

## 2. 系統架構

-   **前端**：Vite + Vue 3
-   **後端**：Node.js (Express)
-   **資料庫**：MySQL
-   **身分驗證**：JWT
-   **其它**：Axios（前端呼叫 API）

------------------------------------------------------------------------

## 3. 功能總覽

### A. 使用者功能

-   註冊 / 登入（JWT）
-   餐廳抽卡（每日限制）
-   群組切換（學校附近 / 家裡附近 / 全部）
-   抽卡結果展示（含稀有度）
-   餐廳收藏
-   抽卡紀錄查詢

### B. 餐廳管理（Admin）

-   餐廳 CRUD
-   設定餐廳稀有度
-   餐廳與群組多對多管理

### C. 群組管理（Admin）

-   群組 CRUD
-   餐廳加入群組

### D. 系統管理

-   使用者管理
-   抽卡紀錄查看
-   機率設定、每日抽卡上限設定

------------------------------------------------------------------------

## 4. 資料庫 Schema

### users

  欄位         說明
  ------------ ----------
  id           PK
  email        帳號
  password     哈希密碼
  name         顯示名稱
  avatar_url   頭像
  created_at   註冊時間

### dishes

  欄位          說明
  ------------- ----------------------
  id            PK
  name          餐廳名稱
  description   描述
  image_url     圖片
  rarity        common / rare / epic
  created_at    建立時間

### groups

  欄位          說明
  ------------- ------------
  id            PK
  name          群組名稱
  slug          程式用代號
  description   群組說明

### dish_groups（多對多）

  欄位       說明
  ---------- ------
  id         PK
  dish_id    FK
  group_id   FK

### draws

  欄位         說明
  ------------ ----------
  id           PK
  user_id      FK
  dish_id      FK
  rarity       稀有度
  created_at   抽卡時間

### favorites

  欄位      說明
  --------- ------
  id        PK
  user_id   FK
  dish_id   FK

------------------------------------------------------------------------

## 5. 抽卡流程

1.  檢查今日抽卡次數是否達上限
2.  依照機率決定稀有度（例如 common 75% / rare 20% / epic 5%）
3.  查詢指定群組中、符合稀有度的餐廳列表
4.  使用 offset 隨機抽一筆（避免 ORDER BY RAND 效能問題）
5.  寫入抽卡紀錄
6.  回傳抽卡結果給前端

------------------------------------------------------------------------

## 6. 前端功能

-   群組切換標籤
-   抽卡動畫（可做卡片翻轉或光線效果）
-   餐廳卡片顯示（名稱 / 圖片 / 稀有度）
-   收藏按鈕
-   歷史紀錄頁面

------------------------------------------------------------------------

## 7. 專案亮點

-   具備後端邏輯（抽卡演算法、限制、機率）
-   資料庫多對多設計（dishes ↔ groups）
-   避免 ORDER BY RAND（效能優化）
-   遵循 RESTful API
-   支援使用者角色（User / Admin）
-   設計可擴展（機率調整、群組新增、地圖功能）
